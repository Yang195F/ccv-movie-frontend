{"ast":null,"code":"import { refreshToken } from \"../services/tokenService\";\nexport const apiClient = async (url, options = {}) => {\n  let token = sessionStorage.getItem(\"authToken\");\n  const headers = {\n    ...options.headers,\n    \"Content-Type\": \"application/json\",\n    ...(token && {\n      Authorization: `Bearer ${token}`\n    })\n  };\n  let res = await fetch(url, {\n    ...options,\n    headers\n  });\n  if (res.status === 401) {\n    const newToken = await refreshToken();\n    if (newToken) {\n      headers[\"Authorization\"] = `Bearer ${newToken}`;\n      res = await fetch(url, {\n        ...options,\n        headers\n      });\n    }\n  }\n  return res;\n};","map":{"version":3,"names":["refreshToken","apiClient","url","options","token","sessionStorage","getItem","headers","Authorization","res","fetch","status","newToken"],"sources":["C:/Users/User/Documents/GitHub/ccv-movie-frontend/src/config/apiClient.ts"],"sourcesContent":["import { refreshToken } from \"../services/tokenService\";\r\n\r\nexport const apiClient = async (url: string, options: RequestInit = {}) => {\r\n  let token = sessionStorage.getItem(\"authToken\");\r\n\r\n  const headers: Record<string, string> = {\r\n    ...options.headers as Record<string, string>,\r\n    \"Content-Type\": \"application/json\",\r\n    ...(token && { Authorization: `Bearer ${token}` }),\r\n  };\r\n\r\n  let res = await fetch(url, { ...options, headers });\r\n\r\n  if (res.status === 401) {\r\n    const newToken = await refreshToken();\r\n    if (newToken) {\r\n      headers[\"Authorization\"] = `Bearer ${newToken}`;\r\n      res = await fetch(url, { ...options, headers });\r\n    }\r\n  }\r\n\r\n  return res;\r\n};\r\n"],"mappings":"AAAA,SAASA,YAAY,QAAQ,0BAA0B;AAEvD,OAAO,MAAMC,SAAS,GAAG,MAAAA,CAAOC,GAAW,EAAEC,OAAoB,GAAG,CAAC,CAAC,KAAK;EACzE,IAAIC,KAAK,GAAGC,cAAc,CAACC,OAAO,CAAC,WAAW,CAAC;EAE/C,MAAMC,OAA+B,GAAG;IACtC,GAAGJ,OAAO,CAACI,OAAiC;IAC5C,cAAc,EAAE,kBAAkB;IAClC,IAAIH,KAAK,IAAI;MAAEI,aAAa,EAAE,UAAUJ,KAAK;IAAG,CAAC;EACnD,CAAC;EAED,IAAIK,GAAG,GAAG,MAAMC,KAAK,CAACR,GAAG,EAAE;IAAE,GAAGC,OAAO;IAAEI;EAAQ,CAAC,CAAC;EAEnD,IAAIE,GAAG,CAACE,MAAM,KAAK,GAAG,EAAE;IACtB,MAAMC,QAAQ,GAAG,MAAMZ,YAAY,CAAC,CAAC;IACrC,IAAIY,QAAQ,EAAE;MACZL,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUK,QAAQ,EAAE;MAC/CH,GAAG,GAAG,MAAMC,KAAK,CAACR,GAAG,EAAE;QAAE,GAAGC,OAAO;QAAEI;MAAQ,CAAC,CAAC;IACjD;EACF;EAEA,OAAOE,GAAG;AACZ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}